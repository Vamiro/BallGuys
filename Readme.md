# Документация проекта

## Описание проекта
Проект представляет собой многопользовательскую игру, использующую Photon для сетевой синхронизации. В проекте реализованы различные компоненты для управления игроком, камерой, ловушками и интерфейсом пользователя.

## Содержание
1. [GameManager](#gamemanager)
2. [CameraWorkComponent](#cameraworkcomponent)
3. [ImpulseTrapComponent](#impulsetrapcomponent)
4. [BaseWindow](#basewindow)
5. [PlayerController](#playercontroller)
6. [RotatorComponent](#rotatorcomponent)
7. [DeathVolume](#deathvolume)
8. [TimingActionComponent](#timingactioncomponent)
9. [FinishVolume](#finishvolume)
10. [WinWindow](#winwindow)
11. [ConnectWindow](#connectwindow)
12. [Launcher](#launcher)
13. [LaunchWindow](#launchwindow)
14. [ForceVolume](#forcevolume)

## GameManager
`GameManager` управляет основными игровыми процессами, такими как создание игрока и обработка загрузки сцен.

### Методы
- `Start()`: Инициализирует сцену и создает игрока, если его еще нет.
- `OnDisable()`: Удаляет обработчик загрузки сцены.
- `OnLeftRoom()`: Загружает начальную сцену при выходе игрока из комнаты.
- `LeaveRoom()`: Вызывает метод выхода из комнаты Photon.

### Настраиваемые поля
- `playerPrefab`: Префаб игрока, который будет использоваться для создания.

## CameraWorkComponent
`CameraWorkComponent` управляет камерой, следящей за игроком.

### Методы
- `Start()`: Начинает следить за целью, если это указано.
- `LateUpdate()`: Обновляет позицию камеры.
- `OnStartFollowing()`: Начинает следить за целью.
- `RotateAround(float mouseX)`: Вращает камеру вокруг цели.
- `Follow()`: Следует за целью.
- `Cut()`: Мгновенно перемещает камеру к цели.

### Настраиваемые поля
- `distance`: Расстояние до цели.
- `height`: Высота камеры над целью.
- `centerOffset`: Смещение камеры.
- `followOnStart`: Следовать ли за целью при старте.

## ImpulseTrapComponent
`ImpulseTrapComponent` управляет ловушкой, которая применяет импульс к игроку.

### Методы
- `Start()`: Инициализирует ловушку и подписывается на события.
- `OnDestroy()`: Отписывается от событий.
- `TimingActionOnSleeping()`: Обрабатывает состояние "спящий".
- `TimingActionOnWaiting()`: Обрабатывает состояние "ожидание".
- `ThrowPlayer()`: Применяет импульс к игроку.
- `TimingActionOnCoolingDown()`: Обрабатывает состояние "охлаждение".
- `OnCollisionEnter(Collision other)`: Обрабатывает столкновение с игроком.
- `OnCollisionExit(Collision other)`: Обрабатывает выход игрока из зоны ловушки.
- `OnDrawGizmos()`: Рисует гизмо для визуализации направления импульса.

### Настраиваемые поля
- `timingActionComponent`: Компонент, управляющий таймингом.
- `impulseDirection`: Направление импульса.
- `impulseForce`: Сила импульса.
- `mRenderer`: Рендерер для изменения материалов.
- `sleepingMaterial`, `waitingMaterial`, `actionMaterial`, `coolingDownMaterial`: Материалы для различных состояний ловушки.

## BaseWindow
`BaseWindow` является базовым классом для окон интерфейса пользователя.

### Методы
- `Show(params object[] args)`: Показывает окно.
- `Hide()`: Скрывает окно.
- `OnShow(params object[] args)`: Абстрактный метод, вызываемый при показе окна.
- `OnHide()`: Абстрактный метод, вызываемый при скрытии окна.

## PlayerController
`PlayerController` управляет игроком, его движением и взаимодействием с камерой.

### Методы
- `Awake()`: Инициализирует локальный экземпляр игрока.
- `Start()`: Начинает следить за игроком.
- `FixedUpdate()`: Обрабатывает ввод и движение игрока.
- `ProcessInputs()`: Обрабатывает ввод пользователя.

### Настраиваемые поля
- `cameraWorkComponent`: Компонент камеры.
- `rb`: Rigidbody игрока.
- `speed`: Скорость движения.
- `maxSpeed`: Максимальная скорость.

## RotatorComponent
`RotatorComponent` вращает объект вокруг заданной оси.

### Методы
- `Start()`: Проверяет наличие Rigidbody.
- `Update()`: Вращает объект.

### Настраиваемые поля
- `rb`: Rigidbody объекта.
- `rotationAxis`: Ось вращения.
- `speed`: Скорость вращения.

## DeathVolume
`DeathVolume` перемещает игрока в точку возрождения при столкновении.

### Методы
- `OnCollisionEnter(Collision other)`: Перемещает игрока в точку возрождения.

### Настраиваемые поля
- `spawnPoint`: Точка возрождения.

## TimingActionComponent
`TimingActionComponent` управляет таймингом действий.

### Методы
- `Update()`: Обновляет состояние таймера.
- `Activate()`: Активирует таймер.

### Настраиваемые поля
- `timeToWait`: Время ожидания перед действием.
- `cooldown`: Время охлаждения после действия.

## FinishVolume
`FinishVolume` отображает окно победы при пересечении финишной линии.

### Методы
- `OnTriggerEnter(Collider other)`: Отображает окно победы.
- `ShowWinWindow(string winner)`: Отображает окно победы с именем победителя.

### Настраиваемые поля
- `winWindow`: Окно победы.

## WinWindow
`WinWindow` отображает сообщение о победе.

### Методы
- `OnShow(params object[] args)`: Устанавливает текст победителя.
- `OnHide()`: Метод, вызываемый при скрытии окна.

### Настраиваемые поля
- `winText`: Текстовое поле для отображения победителя.

## ConnectWindow
`ConnectWindow` отображает сообщение о подключении.

### Методы
- `Update()`: Обновляет текст подключения.
- `OnShow(params object[] args)`: Метод, вызываемый при показе окна.
- `OnHide()`: Метод, вызываемый при скрытии окна.

### Настраиваемые поля
- `connectingText`: Текстовое поле для отображения состояния подключения.

## Launcher
`Launcher` управляет подключением к Photon и созданием/входом в комнаты.

### Методы
- `Awake()`: Инициализирует Photon.
- `Start()`: Показывает окно запуска.
- `Connect()`: Начинает процесс подключения.
- `CreateRoom()`: Создает новую комнату.
- `OnConnectedToMaster()`: Обрабатывает подключение к мастеру.
- `OnDisconnected(DisconnectCause cause)`: Обрабатывает отключение.
- `OnJoinRandomFailed(short returnCode, string message)`: Обрабатывает неудачу при входе в случайную комнату.
- `OnJoinedRoom()`: Обрабатывает успешный вход в комнату.
- `OnPlayerEnteredRoom(Player other)`: Обрабатывает вход игрока в комнату.
- `OnPlayerLeftRoom(Player other)`: Обрабатывает выход игрока из комнаты.

### Настраиваемые поля
- `maxPlayersPerRoom`: Максимальное количество игроков в комнате.
- `launchWindow`: Окно запуска.
- `connectWindow`: Окно подключения.

## LaunchWindow
`LaunchWindow` отображает окно запуска игры.

### Методы
- `Awake()`: Инициализирует кнопки и поля ввода.
- `Start()`: Инициализирует поле ввода имени.
- `OnShow(params object[] args)`: Метод, вызываемый при показе окна.
- `OnPlayButtonClicked()`: Обрабатывает нажатие кнопки "Играть".
- `OnPlayerNameFieldChanged(string value)`: Обрабатывает изменение имени игрока.
- `InitializeNameField()`: Инициализирует поле ввода имени.
- `OnHide()`: Метод, вызываемый при скрытии окна.
- `OnDestroy()`: Удаляет слушатели событий.

### Настраиваемые поля
- `playButton`: Кнопка "Играть".
- `launcher`: Компонент `Launcher`.
- `playerNameInputField`: Поле ввода имени игрока.

## ForceVolume
`ForceVolume` применяет силу или импульс к игроку при входе в зону действия.

### Методы
- `Start()`: Инициализирует компонент.
- `Update()`: Обновляет направление силы, если включен случайный режим.
- `ChangeDirection(Vector3 newDirection)`: Изменяет направление силы.
- `SyncParticles()`: Синхронизирует частицы с направлением силы.
- `OnCollisionEnter(Collision other)`: Применяет импульс к игроку.
- `OnTriggerStay(Collider other)`: Применяет силу к игроку.
- `OnDrawGizmos()`: Рисует гизмо для визуализации направления силы.

### Настраиваемые поля
- `collider`: Коллайдер зоны действия.
- `particleSystem`: Система частиц.
- `forceType`: Тип силы (Force или Impulse).
- `direction`: Направление силы.
- `strength`: Сила воздействия.
- `isRandom`: Включить случайное изменение направления.
- `randomTime`: Время между изменениями направления.

## Пояснения
Некоторые пункты из технического задания были изменены для улучшения проекта и адаптации под многопользовательский формат:

1. **Многопользовательский режим**. Изначально ТЗ предполагало одиночную игру, но была реализована многопользовательская версия с использованием Photon. Это добавило соревновательный элемент и сделало игру более динамичной.

2. **Точки возрождения вместо поражения**. Вместо мгновенного завершения игры при падении, добавлена система возрождения через компонент `DeathVolume`, что уменьшает фрустрацию игроков и позволяет продолжать игру после ошибок.

3. **Настраиваемые параметры**. В коде некоторые параметры (например, скорость ловушек, сила импульса) не заданы напрямую, так как они могут быть легко настроены в инспекторе Unity, что делает проект более гибким для тестирования и дальнейших изменений.

Эти изменения улучшили игровой процесс, сохранив основную идею игры и сделав её более подходящей для многопользовательского взаимодействия.